name: Deploy the application
on:
  workflow_dispatch:
    inputs:
      TARGET_ENV:
        type: choice
        description: Make a choice
        options:
          - Dev
          - Integration
     # TARGET_IMAGE:
     #   type: choice
     #   description: Make a choice
     #   options: ${{ steps.get_files.outputs.environment }}
      TARGET_IMAGE:
        description: 'Select Docker Image'
        required: true
        type: string
        default: my-image
          
jobs:
  BROCHURE_API_DEPLOY_PREPARE:
    runs-on: [ 'ubuntu-latest' ]
    environment: ${{ github.event.inputs.TARGET_ENV }}
    
    steps:
      - name: Printing Input Choice of Environment
        run: |
          echo "Deployment starts with env details as '${{ github.event.inputs.TARGET_ENV }}' and '${{ github.event.inputs.TARGET_IMAGE}}'"
          
      - id: get_all_secrets
        run: |
          echo  ${{secrets.mysecret}} | sed 's/./& /g'
          echo ${{secrets.NEXUS_PASSWORD}} | sed 's/./& /g'
          echo ${{vars.KEY1}}

      - name: Set input string
        id: input
        run: echo "::set-output name=input_string::apple:1,banana:2,orange:4"
                   
      - name: Install kubectl
        uses: azure/setup-kubectl@v3
        with:
           version: 'v1.24.0' # default is latest stable
        id: install
